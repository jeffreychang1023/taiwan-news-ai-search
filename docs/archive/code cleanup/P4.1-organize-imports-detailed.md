# P4.1: Organize Imports - Detailed Implementation

**Estimated Effort**: 0.1 day
**Impact**: Low - Improves code consistency
**ROI**: ⭐

---

## Problem Statement

Imports across the codebase are not consistently organized:
- No standard ordering (stdlib, third-party, local)
- Some files have unused imports
- Import grouping varies between files

---

## Solution

Use `isort` tool to automatically organize imports across all files.

---

## Implementation

### Step 1: Install isort

```bash
pip install isort
```

### Step 2: Configure isort

#### File: `pyproject.toml`

```toml
[tool.isort]
profile = "black"
line_length = 100
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
ensure_newline_before_comments = true

# Project-specific sections
known_first_party = [
    "core",
    "methods",
    "reasoning",
    "retrieval",
    "pre_retrieval",
    "webserver",
    "chat"
]
known_third_party = [
    "aiohttp",
    "openai",
    "anthropic",
    "qdrant_client",
    "numpy",
    "xgboost"
]

sections = [
    "FUTURE",
    "STDLIB",
    "THIRDPARTY",
    "FIRSTPARTY",
    "LOCALFOLDER"
]

# Skip certain files/directories
skip = [
    ".git",
    ".venv",
    "venv",
    "__pycache__",
    "build",
    "dist"
]
skip_gitignore = true

# Import heading comments (optional)
import_heading_stdlib = "Standard Library"
import_heading_thirdparty = "Third Party"
import_heading_firstparty = "Local"
```

#### Alternative: `.isort.cfg`

```ini
[settings]
profile = black
line_length = 100
multi_line_output = 3
include_trailing_comma = True
force_grid_wrap = 0
use_parentheses = True
ensure_newline_before_comments = True
known_first_party = core,methods,reasoning,retrieval,pre_retrieval,webserver,chat
known_third_party = aiohttp,openai,anthropic,qdrant_client,numpy,xgboost
sections = FUTURE,STDLIB,THIRDPARTY,FIRSTPARTY,LOCALFOLDER
skip = .git,.venv,venv,__pycache__,build,dist
skip_gitignore = True
```

---

### Step 3: Run isort

```bash
# Check what would change (dry run)
isort code/python/ --check-only --diff

# Fix all imports
isort code/python/

# Fix specific file
isort code/python/reasoning/orchestrator.py
```

---

### Example Transformation

#### BEFORE

```python
import json
from reasoning.agents.analyst import AnalystAgent
import logging
from typing import Dict, List, Any, Optional
import asyncio
from core.config import CONFIG
import time
from qdrant_client import QdrantClient
from reasoning.utils.console_tracer import ConsoleTracer
import os
from datetime import datetime
```

#### AFTER

```python
# Standard Library
import asyncio
import json
import logging
import os
import time
from datetime import datetime
from typing import Any, Dict, List, Optional

# Third Party
from qdrant_client import QdrantClient

# Local
from core.config import CONFIG
from reasoning.agents.analyst import AnalystAgent
from reasoning.utils.console_tracer import ConsoleTracer
```

---

### Step 4: Add Pre-commit Hook

#### File: `.pre-commit-config.yaml`

```yaml
repos:
  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort
        name: isort (python)
        args: ["--profile", "black"]
```

Install pre-commit:

```bash
pip install pre-commit
pre-commit install
```

---

### Step 5: CI Integration

#### File: `.github/workflows/lint.yml`

```yaml
name: Lint

on: [push, pull_request]

jobs:
  isort:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      - run: pip install isort
      - run: isort code/python/ --check-only --diff
```

---

## Commands Summary

```bash
# Install
pip install isort

# Check all files
isort code/python/ --check-only --diff

# Fix all files
isort code/python/

# Fix single file
isort code/python/reasoning/orchestrator.py

# Show stats
isort code/python/ --show-files

# Remove unused imports (with autoflake)
pip install autoflake
autoflake --remove-all-unused-imports --in-place --recursive code/python/
```

---

## Benefits

- ✅ Consistent import ordering across codebase
- ✅ Automatic via pre-commit hook
- ✅ CI validation
- ✅ Reduces merge conflicts
- ✅ Easier code review
